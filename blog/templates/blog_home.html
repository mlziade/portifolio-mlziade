{% extends "blog_base.html" %}
{% load static %}

{% block title %}Blog - Posts{% endblock %}

{% block extra_css %}
{% load compress %}
{% compress css %}
<link rel="stylesheet" href="{% static 'blog/css/blog_home.css' %}">
{% endcompress %}
{% endblock %}

{% block content %}
<div class="posts-container">
  <h1 class="page-header">Latest Posts</h1>

  {% if posts %}
  <div class="posts-list">
    {% for post in posts %}
    <article class="post-card">
      <a href="{% url 'blog:blog_post_detail' post.slug %}" class="post-thumbnail">
        <div class="post-thumbnail-container">
          {% if post.thumbnail %}
          <img src="{% static 'blog/files/thumbnails/' %}{{ post.thumbnail }}" alt="{{ post.title }}" loading="lazy">
          {% else %}
          <img src="{% static 'placeholder-thumbnail.jpg' %}" alt="{{ post.title }}" loading="lazy">
          {% endif %}
        </div>
      </a>

      <div class="post-content">
        <a href="{% url 'blog:blog_post_detail' post.slug %}" class="post-title">{{ post.title }}</a>

        <div class="post-meta">
          <span class="post-date">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
            </svg>
            {{ post.published_date|date:"F d, Y" }}
          </span>

          {% if post.tags.exists %}
          <span class="post-tags">
            {% for tag in post.tags.all %}
            <a href="#tag-{{ tag.slug }}" class="tag">#{{ tag.name }}</a>{% if not forloop.last %}, {% endif %}
            {% endfor %}
          </span>
          {% endif %}
        </div>

        <p class="post-excerpt">{{ post.excerpt|truncatewords:30 }}</p>
      </div>
    </article>
    {% endfor %}
  </div>

  <!-- Pagination -->
  {% if posts.has_other_pages %}
  <div class="pagination">
    {% if posts.has_previous %}
    <a href="?page=1">&laquo; First</a>
    <a href="?page={{ posts.previous_page_number }}">Previous</a>
    {% else %}
    <span class="disabled">&laquo; First</span>
    <span class="disabled">Previous</span>
    {% endif %}

    <span class="current">Page {{ posts.number }} of {{ posts.paginator.num_pages }}</span>

    {% if posts.has_next %}
    <a href="?page={{ posts.next_page_number }}">Next</a>
    <a href="?page={{ posts.paginator.num_pages }}">Last &raquo;</a>
    {% else %}
    <span class="disabled">Next</span>
    <span class="disabled">Last &raquo;</span>
    {% endif %}
  </div>
  {% endif %}
  {% else %}
  <div class="no-posts">
    <p>No posts available yet. Check back soon!</p>
  </div>
  {% endif %}
</div>
{% endblock %}
