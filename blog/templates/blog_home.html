{% extends "blog_base.html" %}
{% load static %}

{% block title %}Blog - Posts{% endblock %}

{% block extra_css %}
<style>
  .posts-container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem 0;
  }

  .page-header {
    color: var(--text-primary);
    margin-bottom: 2rem;
    font-size: 2.5rem;
  }

  .posts-list {
    display: flex;
    flex-direction: column;
    gap: 2rem;
  }

  .post-card {
    display: flex;
    flex-direction: row;
    gap: 1.5rem;
    padding: 1.5rem 0;
    transition: opacity 0.2s ease;
  }

  .post-card:hover {
    opacity: 0.8;
  }

  .post-thumbnail {
    flex-shrink: 0;
    width: 280px;
    height: 180px;
    border-radius: 8px;
    overflow: hidden;
    cursor: pointer;
  }

  .post-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
  }

  .post-thumbnail:hover img {
    transform: scale(1.05);
  }

  .post-content {
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  .post-title {
    color: var(--text-primary);
    font-size: 1.8rem;
    margin-bottom: 0.5rem;
    cursor: pointer;
    text-decoration: none;
    transition: color 0.3s ease;
  }

  .post-title:hover {
    color: #4a9eff;
  }

  .post-meta {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
    color: var(--text-secondary);
    font-size: 0.9rem;
  }

  .post-date {
    display: flex;
    align-items: center;
    gap: 0.3rem;
  }

  .post-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .tag {
    background-color: #2a2a2a;
    color: var(--text-secondary);
    padding: 0.3rem 0.8rem;
    border-radius: 20px;
    font-size: 0.85rem;
    text-decoration: none;
    transition: background-color 0.3s ease;
  }

  .tag:hover {
    background-color: #3a3a3a;
    color: var(--text-primary);
  }

  .post-excerpt {
    color: var(--text-secondary);
    line-height: 1.6;
    margin-top: auto;
  }

  .pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    margin-top: 3rem;
    padding: 2rem 0;
  }

  .pagination a,
  .pagination span {
    color: var(--text-primary);
    padding: 0.5rem 1rem;
    border-radius: 6px;
    text-decoration: none;
    transition: background-color 0.3s ease;
  }

  .pagination a:hover {
    background-color: #2a2a2a;
  }

  .pagination .current {
    background-color: #4a9eff;
    color: white;
  }

  .pagination .disabled {
    color: var(--text-secondary);
    opacity: 0.5;
    cursor: not-allowed;
  }

  .no-posts {
    text-align: center;
    color: var(--text-secondary);
    padding: 4rem 0;
    font-size: 1.2rem;
  }

  @media (max-width: 768px) {
    .post-card {
      flex-direction: column;
    }

    .post-thumbnail {
      width: 100%;
      height: 200px;
    }
  }
</style>
{% endblock %}

{% block content %}
<div class="posts-container">
  <h1 class="page-header">Latest Posts</h1>

  {% if posts %}
  <div class="posts-list">
    {% for post in posts %}
    <article class="post-card">
      <a href="{% url 'blog:blog_post_detail' post.slug %}" class="post-thumbnail">
        {% if post.thumbnail %}
        <img src="{{ post.thumbnail.url }}" alt="{{ post.title }}" loading="lazy">
        {% else %}
        <img src="{% static 'placeholder-thumbnail.jpg' %}" alt="{{ post.title }}" loading="lazy">
        {% endif %}
      </a>

      <div class="post-content">
        <a href="{% url 'blog:blog_post_detail' post.slug %}" class="post-title">{{ post.title }}</a>

        <div class="post-meta">
          <span class="post-date">
            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
              <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z"/>
            </svg>
            {{ post.published_date|date:"F d, Y" }}
          </span>
        </div>

        {% if post.tags.exists %}
        <div class="post-tags">
          {% for tag in post.tags.all %}
          <a href="#tag-{{ tag.slug }}" class="tag">#{{ tag.name }}</a>
          {% endfor %}
        </div>
        {% endif %}

        <p class="post-excerpt">{{ post.excerpt|truncatewords:30 }}</p>
      </div>
    </article>
    {% endfor %}
  </div>

  <!-- Pagination -->
  {% if posts.has_other_pages %}
  <div class="pagination">
    {% if posts.has_previous %}
    <a href="?page=1">&laquo; First</a>
    <a href="?page={{ posts.previous_page_number }}">Previous</a>
    {% else %}
    <span class="disabled">&laquo; First</span>
    <span class="disabled">Previous</span>
    {% endif %}

    <span class="current">Page {{ posts.number }} of {{ posts.paginator.num_pages }}</span>

    {% if posts.has_next %}
    <a href="?page={{ posts.next_page_number }}">Next</a>
    <a href="?page={{ posts.paginator.num_pages }}">Last &raquo;</a>
    {% else %}
    <span class="disabled">Next</span>
    <span class="disabled">Last &raquo;</span>
    {% endif %}
  </div>
  {% endif %}
  {% else %}
  <div class="no-posts">
    <p>No posts available yet. Check back soon!</p>
  </div>
  {% endif %}
</div>
{% endblock %}
